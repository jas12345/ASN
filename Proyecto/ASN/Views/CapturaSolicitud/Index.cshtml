@model ASN.Models.CatSolicitudesSel_Result
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
   .primerLabel{
       font-weight:normal;
   }

   label{
       font-size:small;
   }
</style>



@{
    int folioId = 0;

    if (Model != null)
    {
        folioId = Model.FolioSolicitud;
    }

    @Html.Hidden("folioId", folioId)
}

@if (User.Identity.IsAuthenticated)
{
<div class="container-fluid">
    <table class="table">
        <tbody>
            <tr>
                <td><label class="primerLabel" id="lblCCMSID">CCMSID:</label></td>
                <td><label id="CCMSID">1764285</label></td>
                <td><label class="primerLabel" id="lblSite">Site:</label></td>
                <td><label id="Site">TPMXN Alpha</label></td>
                <td><label class="primerLabel" id="lblConceptoMotivo">ConceptoMotivo:</label></td>
                <td><label id="ConceptoMotivox">Error en PS System</label></td>
            </tr>
            <tr>
                <td><label class="primerLabel" id="lblNombre">Nombre:</label></td>
                <td><label id="Nombre"> Adolfo Antonio Martinez Huerta</label></td>
                <td><label class="primerLabel" id="lblConcepto">Concepto:</label></td>
                <td><label id="Concepto">Horas Faltantes</label></td>
                <td><label class="primerLabel" id="lblResponsableCCMSID">Responsable de incidente:</label></td>
                <td><label id="ResponsableCCMSID">863481</label></td>
            </tr>
            <tr>
                <td><label class="primerLabel" id="lblPuesto">Puesto:</label></td>
                <td><label id="Puesto">Incorporation Analyst</label></td>
                <td><label class="primerLabel" id="lblParametro">Parametro:</label></td>
                <td><label id="Parametrox">11.50</label></td>
                <td><label class="primerLabel" id="lblPeriodoOP">Período original de pago:</label></td>
                <td><label id="PeriodoOP">2019_05</label></td>
            </tr>
            <tr>
                <td><label class="primerLabel" id="lblContrato">Contrato:</label></td>
                <td><label id="Contratox">HTG</label></td>
                <td><label class="primerLabel" id="lblMotivo">Motivo:</label></td>
                <td><label id="Motivox">Error</label></td>
                <td><label class="primerLabel" id="lblNombreRespo">Nombre responsable:</label></td>
                <td><label id="NombreRespo">Patricio Javier Hernández Loustalot Laclette</label></td>
            </tr>
        </tbody>
    </table>
</div>

<div class="container">
    @*<div class="row">
        <div class="col-md-2">
            <label class="primerLabel" id="lblCCMSID">CCMSID:</label>
        </div>
        <div class="col-md-2">
            <label id="CCMSID">1764285</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblSite">Site:</label>
        </div>
        <div class="col-md-2">
            <label id="Site">TPMXN Alpha</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblConceptoMotivo">ConceptoMotivo:</label>
        </div>
        <div class="col-md-2">
            <label id="ConceptoMotivox">Error en PS System</label>
        </div>
    </div>*@
    @*<div class="row">
        <div class="col-md-2">
            <label class="primerLabel" id="lblNombre">Nombre:</label>
        </div>
        <div class="col-md-2">
            <label id="Nombre"> Adolfo Antonio Martinez Huerta</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblConcepto">Concepto:</label>
        </div>
        <div class="col-md-2">
            <label id="Concepto">Horas Faltantes</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblResponsableCCMSID">Responsable de incidente:</label>
        </div>
        <div class="col-md-2">
            <label id="ResponsableCCMSID">863481</label>
        </div>
    </div>*@
    @*<div class="row">
        <div class="col-md-2">
            <label class="primerLabel" id="lblPuesto">Puesto:</label>
        </div>
        <div class="col-md-2">
            <label id="Puesto">Incorporation Analyst</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblParametro">Parametro:</label>
        </div>
        <div class="col-md-2">
            <label id="Parametrox">11.50</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblPeriodoOP">Período original de pago:</label>
        </div>
        <div class="col-md-2">
            <label id="PeriodoOP">2019-_05</label>
        </div>
    </div>*@
    @*<div class="row">
        <div class="col-md-2">
            <label class="primerLabel" id="lblContrato">Contrato:</label>
        </div>
        <div class="col-md-2">
            <label id="Contratox">HTG</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblMotivo">Motivo:</label>
        </div>
        <div class="col-md-2">
            <label id="Motivox">Error</label>
        </div>
        <div class="col-md-2">
            <label class="primerLabel" id="lblNombreRespo">Nombre responsable:</label>
        </div>
        <div class="col-md-2">
            <label id="NombreRespo">Patricio Javier Hernández Loustalot Laclette</label>
        </div>
    </div>*@
</div>
    <br />
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-4 col-lg-offset-3">
                <label>Periodo de nómina actual</label>
                @(Html.Kendo().DropDownList().DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("GetPeriodoNominaCMB", "CapturaSolicitud");
                        });
                //.ServerFiltering(true);
                })
                .Filter("contains")
                .OptionLabel("- Seleccione Periodo de Nomina - ")
                .DataValueField("Ident")
                .DataTextField("Valor")
                .Name("PeriodoNomina_Id")
                .SelectedIndex(1)
                .Enable(false)
                .HtmlAttributes(new { required = "required", style = "text-align:center;width: 15.4em", validationMessage = "Este campo es requerido." })
                )
            </div>
            <div class="col-lg-4">
                <label>Estatus</label>
                @(Html.Kendo().TextBox().Name("Estatus")
                .Enable(false)
                .Value(string.IsNullOrEmpty(Model.Estatus) ? "Nuevo" : Model.Estatus)
                )
            </div>
        </div>
        <br />
        @*<div class="row">
                <div class="col-lg-4">
                    @(Html.Kendo().Button().Icon("k-icon k-i-file-add").Name("Salvar").HtmlAttributes(new { StyleBundle = "width:15.4em;" } ).Content("Crear nueva solicitud"))
                </div>
            </div>*@
    </div>
    <br />
    <div class="container-fluid">
        <div id="Captura">
            <div class="row">
                <div class="col-lg-12 ">
                    <table class="table-responsive table" cellpadding="1">
                        <tr>
                            <th scope="col">
                                CCMSID
                            </th>
                            <th scope="col">
                                Concepto
                            </th>
                            <th scope="col">
                                Parametro
                            </th>
                            <th scope="col">
                                Motivo
                            </th>
                            <th scope="col">
                                ConceptoMotivo
                            </th>
                            <th scope="col">
                                Responsable de Incidente (CCMSID)
                            </th>
                            <th scope="col">
                                Período Original de Pago
                            </th>
                        </tr>
                        <tr>
                            <td>
                                @(Html.Kendo().NumericTextBox()
                                .Name("CCMSIDSolicitado")
                                .Spinners(false)
                                .Decimals(0)
                                .Format("0.")
                                .Min(0)
                                //.Step(5)
                                //.Value(0)
                                .HtmlAttributes(new { style = "text-align:center;", maxlength = "10" })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().DropDownList().DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("GetConceptosCMB", "CapturaSolicitud");
                                    });
                                            //.ServerFiltering(true);
                                        })
                                .Filter("contains")
                                .OptionLabel("- Conceptos - ")
                                .DataValueField("Ident")
                                .DataTextField("Valor")
                                .Name("Conceptos")
                                //.SelectedIndex(1)
                                .Enable(true)
                                .HtmlAttributes(new { required = "required", style = "text-align:center;width: 15.4em", validationMessage = "Este campo es requerido." })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().NumericTextBox()
                                .Name("Parametro")
                                .Spinners(false)
                                .Decimals(2)
                                .Format("0.00")
                                .Min(0)
                                //.Step(5)
                                //.Value(0)
                                .HtmlAttributes(new { style = "text-align:center;", maxlength = "10" })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().DropDownList().DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("GetMotivosCMB", "CapturaSolicitud");
                                    });
                                            //.ServerFiltering(true);
                                        })
                                .Filter("contains")
                                .OptionLabel("- Motivo - ")
                                .DataValueField("Id")
                                .DataTextField("Value")
                                .Name("Motivo")
                                //.SelectedIndex(1)
                                .Enable(true)
                                .HtmlAttributes(new { required = "required", style = "text-align:center;width: 15.4em", validationMessage = "Este campo es requerido." })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().DropDownList().DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("GetConceptosMotivosCMB", "CapturaSolicitud");
                                    });
                                            //.ServerFiltering(true);
                                        })
                                .Filter("contains")
                                .OptionLabel("- Concepto Motivo - ")
                                .DataValueField("Ident")
                                .DataTextField("Valor")
                                .Name("ConceptoMotivo")
                                //.SelectedIndex(1)
                                .Enable(true)
                                .HtmlAttributes(new { required = "required", style = "text-align:center;width: 15.4em", validationMessage = "Este campo es requerido." })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().NumericTextBox()
                                .Name("CCMSIDIncidente")
                                .Spinners(false)
                                .Decimals(0)
                                .Format("0.")
                                .Min(0)
                                //.Step(5)
                                //.Value(0)
                                .HtmlAttributes(new { style = "text-align:center;width: 15.4em", maxlength = "10" })
                                )
                            </td>
                            <td>
                                @(Html.Kendo().DropDownList().DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("GetPeriodoNominaCMB", "CapturaSolicitud");
                                    });
                                            //.ServerFiltering(true);
                                        })
                                .Filter("contains")
                                .OptionLabel("- Período Incidente - ")
                                .DataValueField("Ident")
                                .DataTextField("Valor")
                                .Name("PeríodoIncidente")
                                //.SelectedIndex(1)
                                .Enable(true)
                                .HtmlAttributes(new { required = "required", style = "text-align:center;width: 15.4em", validationMessage = "Este campo es requerido." })
                                )
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="col-lg-12">
                    @(Html.Kendo().Button().Name("Saved").Content("Saved").Events(x => x.Click("Salvar")))
                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                @(Html.Kendo().Grid<ASN.Models.CatCargaRapidaSel_Result>()
                .Name("gridSolicitud")
                .Columns(column =>
                {
                //column.Command(command => { command.Custom("Editar").Text("<span class='k-icon k-i-edit'></span> Editar").Click("EditaSolicitud"); }).Width(40);
                column.Bound(c => c.CargaRapidaId).Width(40).Title("Id").Visible(true).Filterable(true);
                    column.Bound(c => c.FolioSolicitudId).Title("FolioId").Filterable(true).Width(70).Visible(false);
                    column.Bound(c => c.CCMSID).Title("CCMSID").Filterable(true).Width(70);
                    column.Bound(c => c.ConceptoId).Title("Concepto").Width(70).Filterable(true);
                    column.Bound(c => c.Justificacion).Title("Justificacion").Filterable(true).Width(70);
                    column.Bound(c => c.Motivo).Title("Motivo").Width(70);
                })
                .HtmlAttributes(new { style = "height: 475px;" })
                .Scrollable(sorteable => sorteable.Virtual(false))
                .Sortable()
                .PersistSelection()
                .AutoBind(false)
                //.Events(eve => eve.SaveChanges("onSave"))//.Change("onChange")
                .Filterable(ftb => ftb.Mode(GridFilterMode.Row))
                .DataSource(dataSource => dataSource
                    .Ajax()
                    .Model(model =>
                    {
                        model.Id(c => c.CargaRapidaId);
                        model.Field(c => c.CargaRapidaId).Editable(true);
                        model.Field(c => c.FolioSolicitudId).Editable(true);
                        model.Field(c => c.CCMSID).Editable(true);
                        model.Field(c => c.ConceptoId).Editable(true);
                        model.Field(c => c.Justificacion).Editable(true);
                        model.Field(c => c.Motivo).Editable(true);
                    })
                    .Read(read => read.Action("GetSolicitudesRapidas", "CapturaSolicitud").Data("GetPerfil").Data("getFolio"))
                //.Update(update => update.Action("UpdatePerdiodoNomina", "PeriodoNomina").Type(HttpVerbs.Post))
                //.Create(create => create.Action("CrearSolicitudPorEmpleado", "CapturaSolicitud").Type(HttpVerbs.Post))
                //.Events(ev => ev.Error("errorsote").RequestEnd("valida"))
                )
                .Navigatable()
                .Pageable(pageable => pageable
                .Refresh(true)
                .PageSizes(true)
                .ButtonCount(5)
                .Numeric(true)
                .PreviousNext(true)
                .Messages(messages =>
                {
                    messages.ItemsPerPage("Registros por página");
                    messages.Empty("Sin información para mostrar");
                    messages.First("Primera");
                    messages.Page("Página");
                    messages.Last("Última");
                    messages.Previous("Anterior");
                    messages.Next("Siguiente");
                    messages.Refresh("Actualizar");
                    messages.Of("De");
                    messages.MorePages("Mas páginas");
                    messages.Display("{0} a {1} de {2}");
                })
                )
                )
            </div>
        </div>
    </div>


    @*@(Html.Kendo().Window()
        .Name("windowNotifica")
        .Title("Notificación")
        .Content("")
        .Iframe(true)
        .Draggable()
        .Actions(a => a.Minimize())
        .Width(450)
        .Height(300)
        .Visible(false)
        .Modal(true)
        )*@

    <script>
        @*var urlSolicitud = '@Url.Action("CreateSolicitud", "Solicitudes")';
        var urlSolicitudDefault = '@Url.Action("Index", "Solicitudes")';
        var urlSeleccionaPersonal = '@Url.Action("SelecionaEmpleadosSolicitud", "Solicitudes")';*@
    </script>
}
else
{
    <script type="text/javascript">
        $(function(){
            window.location.href = "@Url.Action("Index","Inicio", new { area = "" }, null)";
        });
        </script>
}
@*@Scripts.Render("~/bundles/Solicitudes")*@

<script src="~/Scripts/CapturaSolicitud.js"></script>

<script>
    var InfoCCMSID = '@Url.Action("GetUserInfo","CapturaSolicitud")';
</script>